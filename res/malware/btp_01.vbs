'dblankenship 2_2019
curUser = CreateObject("WScript.Network").UserName
virusVBS = "c:\users\"+curUser+"\appdata\roaming\microsoft\windows\Start Menu\Programs\Startup\virus.vbs"
virusEXE = "c:\users\"+curUser+"\virus.exe"
fa_hidden=2
Set fs= CreateObject("Scripting.FileSystemObject")
Set objShell = wscript.createobject("wscript.shell")

'delete existing drop files if present
if fs.FileExists(virusEXE) then fs.DeleteFile(virusEXE) end if
if fs.FileExists(virusVBS) then fs.DeleteFile(virusVBS) end if

'create file in startup
virusVBS = "c:\users\"+curUser+"\appdata\roaming\microsoft\windows\Start Menu\Programs\Startup\virus.vbs"
atStartup = StrComp(virusVBS, Wscript.ScriptFullName, vbTextCompare) = 0
if not atStartup then
	fs.CopyFile Wscript.ScriptFullName, virusVBS
else
virus2VBS = "c:\users\"+curUser+"\appdata\roaming\microsoft\windows\Start Menu\Programs\Startup\virus2.vbs"
	if fs.FileExists(virus2VBS) then fs.DeleteFile(virus2VBS) end if
	set vf = fs.CreateTextFile(virus2VBS)
	vf.Write("'BTPdemofile")
	vf.close
end if

'create executable in home directory
virusEXE = "c:\users\"+curUser+"\desktop\virus.exe"
If (fs.FileExists(virusEXE)) Then fs.DeleteFile virusEXE end if
set tf = fs.CreateTextFile(virusEXE)
tf.write("BTPdemofile")
tf.close

'set files attributes to hidden
Set objFile = fs.GetFile(virusEXE)
objFile.Attributes = objFile.Attributes OR fa_hidden

'cleanup
if fs.FileExists(virusEXE) then fs.DeleteFile(virusEXE) end if
if fs.FileExists(virusVBS) then fs.DeleteFile(virusVBS) end if
if fs.FileExists(virus2VBS) then fs.DeleteFile(virus2VBS) end if

'do some shady stuff
objShell.Exec("reg /?")
objShell.Exec("mshta.exe")
objShell.Exec("powershell -ep bypass -windowstyle hidden -e d3JpdGUtaG9zdCBoZWxsbw0Kd3JpdGUtaG9zdCBoZWxsbw0Kd3JpdGUtaG9zdCBoZWxsbw0Kd3JpdGUtaG9zdCBoZWxsbw==")